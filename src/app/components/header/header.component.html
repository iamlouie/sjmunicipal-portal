<div class="header__inner">
  <div class="brand" aria-label="Application title">
    <button type="button" class="hamburger" aria-label="Open menu" [attr.aria-expanded]="menuOpen" aria-controls="header-menu" (click)="toggleMenu()">
      <span class="hamburger__box" aria-hidden="true">
        <span class="hamburger__inner" [class.is-open]="menuOpen"></span>
      </span>
    </button>
    <span class="brand__text">Cabalian LGU Portal</span>
  </div>
  <nav class="main-nav" aria-label="Main navigation">
    <ul class="main-nav__list">
      <!-- Navigation items placeholder -->
    </ul>
  </nav>
  <div class="flex-spacer" aria-hidden="true"></div>
  <ng-container *ngIf="!auth.isAuthenticated(); else loggedIn">
    <button type="button" class="btn btn--primary login-btn" (click)="openLogin()">Login</button>
  </ng-container>
  <ng-template #loggedIn>
    <div class="user-chip" aria-label="Logged in user">
      <span class="user-chip__name">{{ auth.user()?.username }}</span>
  <button type="button" class="btn btn--sm btn--logout" (click)="logout()" aria-label="Logout">Logout</button>
    </div>
  </ng-template>
  
</div>

<!-- Hamburger menu drawer -->
<div class="menu-overlay" *ngIf="menuOpen" (click)="closeMenu()" aria-hidden="true"></div>
<div id="header-menu" class="menu-drawer" *ngIf="menuOpen" role="menu" aria-label="Header menu">
  <div class="menu-drawer__header">
    <span class="menu-drawer__title">Menu</span>
    <button type="button" class="menu-close" aria-label="Close menu" (click)="closeMenu()">âœ•</button>
  </div>
  <div class="menu-drawer__section">
    <button type="button" class="menu-item" (click)="toggleHistory()" [attr.aria-expanded]="historyOpen" aria-controls="history-sub">History</button>
    <div id="history-sub" class="history-sub" *ngIf="historyOpen" role="region" aria-label="Recent activity">
      <ul class="history-list in-menu">
        <li *ngFor="let item of history | slice:0:12" class="history-item">
          <span class="history-item__icon" [class.add]="item.action==='add'" [class.update]="item.action==='update'" [class.delete]="item.action==='delete'"></span>
          <div class="history-item__body">
            <div class="history-item__text">{{ item.message }}</div>
            <div class="history-item__meta">{{ item.when | date:'short' }}</div>
          </div>
        </li>
        <li *ngIf="!history.length" class="history-item history-item--empty">No activity yet.</li>
      </ul>
    </div>
  </div>
  <div class="menu-drawer__section">
    <button type="button" class="menu-item" aria-label="Notifications (placeholder)">Notifications <span class="badge" aria-hidden="true" *ngIf="false">0</span></button>
    <p class="menu-note">Notification center coming soon.</p>
  </div>
</div>

<app-login [open]="loginOpen" (closed)="closeLogin()" (loggedIn)="onLoggedIn($event)"></app-login>


